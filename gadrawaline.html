
<html>

    <body>
        <canvas></canvas>
    </body>
            <script type='text/javascript'>
            "use strict";

            const POINT = 'point';
            const LINE = 'line';

            class Draw{
                draw(){
                    throw 'It should be overwritten'; 
                }
            }
            
            class DrawFactory{
                static getInstance(drawType){
                    switch(drawType){
                        case POINT:
                            return new Point();
                        case LINE:
                            return new Line();
                        default:
                            throw 'The type is undefined';
                    }
                }
            }

            class Point extends Draw{
                setPosition(x, y){
                    this.setted = true;
                    this.x = x;
                    this.y = y
                    return this;
                }
                diff(point){
                    if(!this.setted)
                        throw "Point didn't receive the position";
                    return Math.abs(point.x - this.x) + Math.abs(point.y - this.y);
                }
                draw(){
                }
            }

            class Line extends Draw{
                setPoints(points){
                    this.setted = true;
                    this.points = points
                    this.cost = 10000;
                    return this;
                }
                calcCost(idealLine){
                    if(!this.setted)
                        throw "The line is not defined";
                    if(idealLine.points.length != this.points.length)
                        throw "The lines must match the length";
                    var total = 0;
                    for (var i = 0; i < this.points.length; i++) {
                        total += this.points[i].diff(idealLine.points[i]);
                    };
                    this.cost = total;
                }
                bornRandom(size){
                    var points = []
                    while(size--){
                        points.push(DrawFactory.getInstance(POINT).setPosition(Math.round(100 * Math.random()), Math.round(100 * Math.random()))); 
                    }
                    return this.setPoints(points);
                }
                cross(otherLine){
                    if(idealLine.points.length != this.points.length)
                        throw "The lines must match the length";
                    var halfPart = (otherLine.points.length/2);
                    console.log(idealLine.points.slice(0,halfPart));
                    console.log(idealLine.points.slice(halfPart, otherLine.points.length));
                    console.log(this.points.slice(0,halfPart));
                    console.log(this.points.slice(halfPart, otherLine.points.length));
                }
                draw(){
                }
            }


            class Population{
                constructor(objective, size){
                    this.members = [];
                    this.objective = objective;
                    this.generation = 0;
                    while(size--){
                        this.members.push(DrawFactory.getInstance(LINE).bornRandom(this.objective.points.length))
                    }
                }
            }

            let idealLine = DrawFactory.getInstance(LINE).setPoints([
                DrawFactory.getInstance(POINT).setPosition(0,0), 
                DrawFactory.getInstance(POINT).setPosition(1,1), 
                DrawFactory.getInstance(POINT).setPosition(2,2), 
                DrawFactory.getInstance(POINT).setPosition(3,3)]);
            
            let randomLine = DrawFactory.getInstance(LINE).bornRandom(idealLine.points.length);

            let p = new Population(idealLine, 10);

           </script>
</html>
